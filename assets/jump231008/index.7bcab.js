window.__require=function e(t,i,r){function n(l,a){if(!i[l]){if(!t[l]){var c=l.split("/");if(c=c[c.length-1],!t[c]){var s="function"==typeof __require&&__require;if(!a&&s)return s(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+l+"'")}l=c}var h=i[l]={exports:{}};t[l][0].call(h.exports,function(e){return n(t[l][1][e]||e)},h,h.exports,e,t,i,r)}return i[l].exports}for(var o="function"==typeof __require&&__require,l=0;l<r.length;l++)n(r[l]);return n}({Jump:[function(e,t){"use strict";cc._RF.push(t,"92710aGWc9H2J1Mm8vfHzCy","Jump");var i=cc.Enum({platform:0,platform_broken:1,platform_fastCollapsing:2,platform_false:3}),r=e("GameCommon"),n=e("EngineCommon"),o=e("GameControl"),l=e("ChannelCommon"),a=e("StorageModule"),c=e("StatisticsModule"),s=e("LoadResModule"),h=e("AudioModule"),u=e("AdInfo");cc.Class({extends:cc.Component,properties:{bgImage:cc.Node,player:cc.Node,platformLayer:cc.Node,coinLayer:cc.Node,platformPrefab:{type:cc.Prefab,default:[]},giftPrefab:cc.Prefab,giftParticle:cc.Prefab,coinPrefab:cc.Prefab,bellLabel:cc.Label,layerLabel:cc.Label,levelProgressNode:cc.Node,leftBtn:cc.Node,rightBtn:cc.Node,recordBtn:cc.Node,panel:cc.Node},onLoad:function(){o.curScene=this,lastSceneIndex=sceneIndex,sceneIndex=o.SceneName.jump,r.handleEventPerScene(),this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),c.sceneStart("Jump")},onDestroy:function(){c.sceneEnd(),o.curScene=null},start:function(){var e=this;this.topTwo=!0,this.recordI=-1,this.isClick=!1,this.nextClick=!1,this.isNextClick=!1,this.layerNum=0,this.levelCoinNum=0,this.gameOver=!1,this.routeArr=[],this.initData(),this.initCat(),this.initPlatForm(),this.sizeFit(),this.adHandle(),this.recordHandle(),this.initRemindPanel(),o.hideLoadingPanel(function(){e.tutorialHandle(0,0)})},initData:function(){o.updateBellNum(this.bellLabel),this.levelNum=a.getData("levelNum",1),this.levelFloor(this.levelNum)<=250&&-1!=this.levelFloor(this.levelNum)&&(this.levelProgressNode.active=!0),this.jumpStep=a.getData("jumpStep",0),this.unionStep=0},initCat:function(){var e=o.getLocalDressUp(o.curCatName,-1),t=n.newSkeletonData(o.skeletonData),i=this.player.getComponent(sp.Skeleton);i.skeletonData=t,i.setSkin(o.curCatName),i.setAnimation(0,"jiangluosan",!0),o.initDressUp(i,e)},initRemindPanel:function(){var e=this,t=this.player.getComponent(sp.Skeleton).skeletonData;s.getBundleRes(o.gameBundle,"prefabs/miniGameRemindPanel",function(i){var r=cc.instantiate(i);r.active=!1,r.parent=e.panel,r.position=cc.v2(0,0),e.panelCtrl=r.getComponent("MiniGameRemindPanel"),e.panelCtrl.initPanel(t)},cc.Prefab)},recordHandle:function(){if("tt"==channel){this.recordBtn.active=!0,this.updateRecordBtn();var e=this;l.recordInit(function(){e.updateRecordBtn()},function(){l.videoPath&&1!=l.pickId?o.remindPanelCtrl.showRemindPanel(2):l.videoPath&&(cc.find("Canvas/btnShareVideo").active=!0),e.updateRecordBtn()})}else this.recordBtn.active=!1},adHandle:function(){var e;u.adsManager.hideCustomAd(),isHasAd&&!o.isForbid()&&(bannerShowFlag[sceneIndex]?u.adsManager.showBanner():u.adsManager.hideBanner(),e=lastSceneIndex==sceneIndex?"jump-replay":"jump",u.adsManager.showInterVideo(e),u.adsManager.showCustomAd(4))},sizeFit:function(){},tutorialHandle:function(e,t){var i;e==this.jumpStep&&t==this.unionStep&&(0==t?i=cc.find("Canvas/leftHolder/btnLeft"):1==t&&(i=cc.find("Canvas/rightHolder/btnRight")),o.remindPanelCtrl.showTutorialHandle(i))},initPlatForm:function(){this.upPlatformArr=[[1],[1],[1]];for(var e=this.platformLayer.childrenCount-1;e>=0;e--)this.addPlatform(e)},touchStart:function(e){if(this.isNextClick&&(this.nextClick=!1),null!=e&&(this.startPos=e.touch.getLocation()),!this.gameOver&&!this.isClick){var t=this.player.x,i=this.player.y,r=this.node.convertToNodeSpaceAR(this.startPos).x>t;0==this.jumpStep&&(r?(this.jumpStep=1,a.setData("jumpStep",this.jumpStep),o.remindPanelCtrl.hideTutorialNode()):(this.unionStep=1,this.tutorialHandle(0,1))),this.isNextClick=!1,this.nextClick=!0,this.isClick=!0,this.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan",!0),this.playerTouch(t,i,r)}},playerTouch:function(e,t,i){var r=this;h.playEffect("jump");var n=i?e+100:e-100,o=i?e+160:e-160;cc.tween(this.player).to(.3,{position:cc.v2(n,t+250)}).call(function(){r.isNextClick=!0}).to(.33,{position:cc.v2(o,t)}).call(function(){r.isClick=!1,r.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan",!0),r.isPlayerState(),r.isClick||r.nextClick||r.touchStart(null)}).start(),this.platformMove(),this.bgMove()},platformMove:function(){for(var e=this,t=this.platformLayer.childrenCount-1;t>=0;t--)cc.tween(this.platformLayer.children[t]).to(.5,{position:cc.v2(this.platformLayer.children[t].x,this.platformLayer.children[t].y-215)}).call(function(){e.gameOver=!1}).start();for(var i=this.coinLayer.childrenCount-1;i>=0;i--)cc.tween(this.coinLayer.children[i]).to(.5,{position:cc.v2(this.coinLayer.children[i].x,this.coinLayer.children[i].y-215)}).call(function(){e.gameOver=!1}).start();if(this.layerNum++,this.layerLabel.string=this.layerNum.toString(),this.levelFloor(this.levelNum)<=250&&-1!=this.levelFloor(this.levelNum)){var r=1/this.levelFloor(this.levelNum)*this.levelProgressNode.getChildByName("bar").height;this.levelProgressNode.getComponent(cc.ProgressBar).progress=this.layerNum/this.levelFloor(this.levelNum),this.levelProgressNode.getChildByName("bar_icon").y+=r}this.unschedule(this.Func1),this.layerNum+4>this.levelFloor(this.levelNum)&&-1!=this.levelFloor(this.levelNum)||this.scheduleOnce(function(){for(var e=0;e<this.platformLayer.childrenCount;e++)if(this.platformLayer.children[e].y<=-600){this.platformLayer.children[e].y=645,this.coinLayer.children[e].y=645;for(var t=0;t<this.platformLayer.children[e].childrenCount;t++)this.platformLayer.children[e].children[t].childrenCount>0&&this.platformLayer.children[e].children[t].destroyAllChildren();for(var i=0;i<this.coinLayer.children[e].childrenCount;i++)this.coinLayer.children[e].children[i].childrenCount>0&&this.coinLayer.children[e].children[i].destroyAllChildren();this.addPlatform(e)}}.bind(this),.5)},bgMove:function(){var e=this.bgImage,t=cc.find("base",e),i=t.height*t.scaleY,r=cc.find("loop1",e),n=cc.find("loop2",e),o=t.y+cc.winSize.height/2+i/2,l=r.height*r.scaleY;0==e.y&&(r.y=t.y+i/2),cc.tween(e).by(.5,{y:-80}).call(function(){var t=Math.abs(e.y);if(t>=o){var i=Math.floor((t-o)/l)%2;0==i&&(n.y=r.y+l),1==i&&(r.y=n.y+l)}}).start()},loadPlatformNum:function(e,t){var i,r,n=[[],[],[]];if(4==this.platformLayer.children[t].childrenCount){if(this.layerNum+4==this.levelFloor(this.levelNum)){var l=o.threeToFour(this.upPlatformArr[0]);return l=this.arrX(l),n[0][0]=l[0],n}if(e){i=o.threeToFour(this.upPlatformArr[0]),i=this.arrX(i),n[0][0]=i[0],this.levelFloor(this.levelNum)<=10&&this.topTwo&&(n[0][0]=1),r=o.threeToFour(this.upPlatformArr[2]),r=this.moveArr(i,r),r=this.arrX(r);for(var a=Math.floor(1*Math.random()+1),c=0;c<a;c++)n[1][c]=r[c]}else{i=o.threeToFour(this.upPlatformArr[0]),i=this.arrX(i),n[0][0]=i[0],r=o.threeToFour(this.upPlatformArr[2]),r=this.moveArr(i,r),r=this.arrX(r);for(var s=Math.floor(Math.random()*r.length+1),h=0;h<s;h++)n[1][h]=r[h]}}else{if(this.layerNum+4==this.levelFloor(this.levelNum))return i=o.fourToThree(this.upPlatformArr[0]),i=this.arrX(i),n[0][0]=i[0],n;i=o.fourToThree(this.upPlatformArr[0]),i=this.arrX(i),n[0][0]=i[0],this.levelFloor(this.levelNum)<=10&&this.topTwo&&(n[0][0]=1,this.topTwo=!1),r=o.fourToThree(this.upPlatformArr[2]),r=this.moveArr(i,r),r=this.arrX(r);for(var u=Math.floor(Math.random()*r.length+1),d=0;d<u;d++)n[1][d]=r[d]}return n[2]=n[0].concat(n[1]),this.upPlatformArr=n,this.upPlatformArr},moveArr:function(e,t){for(var i=0;i<t.length;i++)e[0]==t[i]&&t.splice(i,1);return t},arrX:function(e){for(var t,i,r=e.length;r;)i=Math.floor(Math.random()*r--),t=e[r],e[r]=e[i],e[i]=t;return e},addPlatform:function(e){var t;t=this.levelFloor(this.levelNum)>100||-1==this.levelFloor(this.levelNum)?this.loadPlatformNum(!1,e):this.loadPlatformNum(!0,e),this.routeArr[e]=t[0];for(var i=0;i<t[0].length;i++)for(var r=0;r<this.platformLayer.children[e].childrenCount;r++)if(t[0][i]==r){if(this.layerNum+4==this.levelFloor(this.levelNum))return this.loadPlatform(0,this.platformPrefab[0],this.platformLayer.children[e].children[r],this.coinLayer.children[e].children[r]),void(cc.instantiate(this.giftPrefab).parent=this.coinLayer.children[e].children[r]);var n=this.isLevelPlatformType(this.levelNum),l=o.platformRandNum(n);this.loadPlatform(l,this.platformPrefab[l],this.platformLayer.children[e].children[r],this.coinLayer.children[e].children[r])}if(!(this.levelFloor(this.levelNum)<=20))for(var a=0;a<t[1].length;a++)for(var c=0;c<this.platformLayer.children[e].childrenCount;c++)if(t[1][a]==c){var s=void 0;this.levelFloor(this.levelNum)<=70&&-1!=this.levelFloor(this.levelNum)?s=Math.floor(1*Math.random()+1):this.levelFloor(this.levelNum)>70&&this.levelFloor(this.levelNum)<=100&&-1!=this.levelFloor(this.levelNum)?s=Math.floor(2*Math.random()+1):(this.levelFloor(this.levelNum)>100||-1==this.levelFloor(this.levelNum))&&(s=Math.floor(3*Math.random()+1)),this.loadPlatform(s,this.platformPrefab[s],this.platformLayer.children[e].children[c],this.coinLayer.children[e].children[c])}},loadPlatform:function(e,t,r,n){if(cc.instantiate(t).parent=r,e!=i.platform_false&&this.layerNum+4!=this.levelFloor(this.levelNum)){var o=Math.floor(5*Math.random()+1);if(1==o||2==o){var l=cc.instantiate(this.coinPrefab);l.parent=n,l.getComponent(cc.Animation).play("coin")}}},isLevelPlatformType:function(e){var t;switch(parseInt(e)){case 1:case 2:case 3:t=4;break;case 4:case 5:case 6:t=6;break;case 7:case 8:t=8;break;default:t=10}return t},levelFloor:function(e){return e>=1&&e<=3?5*(e-1)+10:e>=4&&e<=7?6*e:e>=8&&e<=11?10*e:12==e?130:13==e?170:14==e?210:15==e?230:16==e?250:-1},isPlayerState:function(){for(var e=this,t=this.platformLayer.childrenCount-1;t>=0;t--)if(Math.abs(this.platformLayer.children[t].y+215)<1){if(this.playerTween=cc.tween(this.player).to(3,{position:cc.v2(this.player.x,-750)}),this.recordI=t,3==this.platformLayer.children[t].childrenCount&&(this.player.x<-320||this.player.x>320)||4==this.platformLayer.children[t].childrenCount&&(this.player.x<-480||this.player.x>480))return console.log("\u5931\u8d2511111111111"),this.gameOver=!0,this.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan2",!0),this.playerTween.start(),this.rightBtn.active=!1,this.leftBtn.active=!1,void this.addPopup();for(var i=function(i){var r=e.platformLayer.children[t].children[i],n=e.coinLayer.children[t].children[i];if(Math.abs(e.player.x-r.x)<1){if(null==r.getChildByName("platform"))return e.gameOver=!0,e.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan2",!0),e.playerTween.start(),e.addPopup(),{v:void 0};var l=r.getChildByName("platform").getComponent("PlatformPrefab").type;if(e.Func1=function(){this.gameOver=!0,this.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan2",!0),r.destroyAllChildren(),this.playerTween.start(),this.addPopup()}.bind(e),n.childrenCount>=1){if(null!=n.getChildByName("coin")){h.playEffect("coin");var s=e.bellLabel.node.parent.convertToWorldSpaceAR(cc.v2(0,0));s=n.convertToNodeSpaceAR(s),n.getChildByName("coin").getComponent(cc.Animation).stop("coin"),n.getChildByName("coin").setScale(1,1),cc.tween(n.getChildByName("coin")).to(.29,{position:cc.v2(s)}).call(function(){n.getChildByName("coin").destroy(),o.updateBellNum(e.bellLabel,1),e.levelCoinNum++}).start()}null!=n.getChildByName("gift")&&(e.gameOver=!0,n.getChildByName("gift").destroy(),cc.instantiate(e.giftParticle).parent=e.player,c.eventStatistics("jumpLevelSuc"+e.levelNum),e.levelNum=parseInt(e.levelNum)+1,e.rightBtn.active=!1,e.leftBtn.active=!1,e.scheduleOnce(function(){this.openSucPanelNode()}.bind(e),1),a.setData("levelNum",e.levelNum))}if(0==l)return{v:void 0};1==l?(r.getChildByName("platform").getComponent(cc.Animation).play("platform_broken"),e.scheduleOnce(e.Func1,3)):2==l?(r.getChildByName("platform").getComponent(cc.Animation).play("platform_fastcollapsing"),e.scheduleOnce(e.Func1,1)):3==l&&e.Func1()}},r=0;r<this.platformLayer.children[t].childrenCount;r++){var n=i(r);if("object"==_typeof2(n))return n.v}}},openSucPanelNode:function(){this.panelCtrl.showPanel("success")},addPopup:function(){this.rightBtn.active=!1,this.leftBtn.active=!1,this.scheduleOnce(function(){isHasAd?this.panelCtrl.showPanel("revive"):this.panelCtrl.showPanel("fail"),c.eventStatistics("jumpLevelFail"+this.levelNum)}.bind(this),1)},resurrection:function(e){if(this.rightBtn.active=!0,this.leftBtn.active=!0,this.layerNum==this.levelFloor(this.levelNum))for(var t=0;t<this.coinLayer.children[e].childrenCount;t++)if(this.coinLayer.children[e].children[t].childrenCount>0)return[e,t];return this.platformLayer.children[e].children[this.routeArr[e]].childrenCount>0?[e,this.routeArr[e]]:(0==e?e=5:e-=1,this.platformLayer.children[e].children[this.routeArr[e]].childrenCount>0?[e,this.routeArr[e]]:void 0)},reviveHandle:function(){var e;e=this.resurrection(o.curScene.recordI,!0);var t=o.curScene.platformLayer.children[e[0]].children[e[1]].x;if(o.curScene.platformLayer.children[e[0]].children[e[1]].y,o.curScene.playerTween.stop(),o.curScene.platformLayer.children[e[0]].children[e[1]].getChildByName("platform").getComponent("PlatformPrefab").type!=i.platform&&(o.curScene.platformLayer.children[e[0]].children[e[1]].destroyAllChildren(),cc.instantiate(o.curScene.platformPrefab[i.platform]).parent=o.curScene.platformLayer.children[e[0]].children[e[1]]),e[0]!=o.curScene.recordI){o.curScene.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan",!0);var r=0==e[1]?t+160:t-160,n=0!=e[1];o.curScene.player.setPosition(cc.v2(r,-215)),o.curScene.playerTouch(r,-215,n)}else o.curScene.player.setPosition(cc.v2(t+160,-415)),o.curScene.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan",!1),cc.tween(o.curScene.player).to(.3,{position:cc.v2(t+160-100,-165)}).call(function(){o.curScene.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan",!1)}).to(.33,{position:cc.v2(t,-215)}).call(function(){o.curScene.gameOver=!1,o.curScene.player.getComponent(sp.Skeleton).setAnimation(0,"jiangluosan",!0),o.curScene.isPlayerState()}).start()},updatePanel:function(e,t,i){t.string=o.curScene.layerNum.toString(),e.string=o.curScene.levelCoinNum.toString();var r=a.getData("jumpHighScore",0);o.curScene.layerNum>r&&(r=o.curScene.layerNum,a.setData("jumpHighScore",r)),i.string=r.toString()},btnBack:function(){h.playEffect("click"),o.showLoadingPanel(function(){cc.director.loadScene("game")})},updateRecordBtn:function(){l.recorderFlag?(o.curScene.recordBtn.getChildByName("on").active=!0,o.curScene.recordBtn.getChildByName("off").active=!1):(o.curScene.recordBtn.getChildByName("on").active=!1,o.curScene.recordBtn.getChildByName("off").active=!0)},btnRecord:function(e){h.playEffect("click"),e.target.getComponent(cc.Button).interactable=!1,this.scheduleOnce(function(){e.target.getComponent(cc.Button).interactable=!0},1),l.recordHandle(this.recordFail)},recordFail:function(){o.remindPanelCtrl.showRemindPanel(1)},btnShareVideo:function(){h.playEffect("click"),null!=l.videoPath?r.isCanClick()&&l.shareVideo(this.shareVideoSucHandle,this.shareVideoFailHandle):this.shareVideoFailHandle()},shareVideoSucHandle:function(){cc.find("Canvas/leftHolder/btnShareVideo").active=!1,l.videoPath=null},shareVideoFailHandle:function(){o.remindPanelCtrl.showSimpleRemind("\u64cd\u4f5c\u592a\u9891\u7e41",!1)}}),cc._RF.pop()},{AdInfo:void 0,AudioModule:void 0,ChannelCommon:void 0,EngineCommon:void 0,GameCommon:void 0,GameControl:void 0,LoadResModule:void 0,StatisticsModule:void 0,StorageModule:void 0}],PlatformPrefab:[function(e,t){"use strict";cc._RF.push(t,"a6d3fCjpa9AWK/511Q0T8PE","PlatformPrefab"),cc.Class({extends:cc.Component,properties:{type:0},start:function(){}}),cc._RF.pop()},{}]},{},["Jump","PlatformPrefab"]);