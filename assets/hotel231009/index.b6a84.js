window.__require=function e(t,n,o){function i(a,r){if(!n[a]){if(!t[a]){var h=a.split("/");if(h=h[h.length-1],!t[h]){var c="function"==typeof __require&&__require;if(!r&&c)return c(h,!0);if(s)return s(h,!0);throw new Error("Cannot find module '"+a+"'")}a=h}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){return i(t[a][1][e]||e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<o.length;a++)i(o[a]);return i}({HotelPersonLayer:[function(e,t){"use strict";cc._RF.push(t,"9281b0R5uRMLK4TzcvMdleV","HotelPersonLayer");var n=e("GameControl");cc.Class({extends:cc.Component,properties:{personPre:cc.Prefab,personSpinePre:cc.Prefab,needTipFrameArr:{type:cc.SpriteFrame,default:[]},progressFrameArr:{type:cc.SpriteFrame,default:[]},leaveFrameArr:{type:cc.SpriteFrame,default:[]}},onLoad:function(){n.hotelPersonLayerJs=this,this.personStartPos=890,this.waitCount=0,this.completeCount=0,this.createPersonNum=0,this.leavePersonNum=0,this.createLeavePersonNum=0,this.personScale=1,this.personNeedEnum=cc.Enum({potion:1,make1:2,bed1:3,bed2:4,crucible:5,bed3:6,make2:7,dessert:8})},start:function(){},init:function(){this.maxPersonPosX=cc.winSize.width/2},addPerson:function(e,t,o){void 0===o&&(o=!1);var i=cc.instantiate(this.personSpinePre),s=cc.instantiate(this.personPre);s.parent=this.node,i.parent=s,i.position=cc.v2(0,0),s.x=1160,s.y=-210,s.zIndex=2,s.name="person"+e.toString();var a=s.getComponent("HotelPerson"),r=this.newPersonData();r.waitIndex=t,r.needArr=n.curScene.personNeedArr[e],r.personIndex=e,r.isTouch=0==e,a.hotelPersonData=r,a.init(o),this.waitCount++,this.createPersonNum>=n.curScene.personLevelNum?(this.createLeavePersonNum++,this.createLeavePersonNum>=n.curScene.personLevelNum&&(this.createLeavePersonNum=0),this.leavePersonNum--):this.createPersonNum++},waitPersonMove:function(e){for(var t=0,n=this.node.childrenCount;t<n;t++){var o=this.node.children[t];if("person"==o.name.substr(0,6)){var i=o.getComponent("HotelPerson");0==i.hotelPersonData.waitIndex&&i.movePerson(e)}}},reducePersonWaitIndex:function(){for(var e=0,t=this.node.childrenCount;e<t;e++){var n=this.node.children[e];"person"==n.name.substr(0,6)&&n.getComponent("HotelPerson").reduceWaitIndex()}},addNextPerson:function(){var e=-1;this.createPersonNum<n.curScene.personLevelNum?e=this.createPersonNum:this.leavePersonNum>0&&(e=this.createLeavePersonNum),e>=0&&n.hotelPersonLayerJs.addPerson(e,this.waitCount,!0)},newPersonData:function(){return{personIndex:0,timer:300,ZIndex:1,dir:"L",needArr:[],isTouch:!1,waitIndex:0}}}),cc._RF.pop()},{GameControl:void 0}],HotelPerson:[function(e,t){"use strict";cc._RF.push(t,"5809769DBlD7bxgIG7ezvNr","HotelPerson");var n=e("GameControl"),o=e("EngineCommon"),i=e("MathModule");cc.Class({extends:cc.Component,properties:{thinkNode:cc.Node,thinkImageNode:cc.Node,progressFrameSprite:cc.Sprite,leaveThinkNode:cc.Node,leaveImageNode:cc.Node},onLoad:function(){this.hotelPersonData=null,this.moveIng=!1,this.isPlayeProp=!1,this.oncollisionFlag=!1,this.isMove=!1,this.needIndex=0,this.needName="",this.needMaxIndex=0,this.randNumMoveSpeed(),this.endGame=!1,this.isTouch=!1,this.isWait=!0,this.needTimer=15,this.timerNum=15,this.isOpenTimer=!1},start:function(){this.thinkNode.zIndex=1,this.leaveThinkNode.zIndex=1},init:function(e){var t=this;this.isCanMove=!1,this.personNode=this.node.getChildByName("personSpine"),this.personSpine=this.personNode.getComponent(sp.Skeleton);var s=o.newSkeletonData(n.skeletonData);this.personSpine.skeletonData=s;var a=i.rangeRandom(0,n.petalMsg.length),r=n.petalMsg[a].name;this.personSpine.setSkin(r),o.spineAnimationPlay(this.personSpine,"lvguan-chuansong"),o.spineAnimationPlay(n.curScene.magicCircleSpine,"play"),this._personScale=n.hotelPersonLayerJs.personScale,n.curScene.personJsArr[this.hotelPersonData.personIndex]=this,this.isTouch=this.hotelPersonData.isTouch,this.backTipsType(this.needIndex),this.node.scale=this._personScale,this.personNode.scaleX="L"==this.hotelPersonData.dir?-1:1,this.needMaxIndex=this.hotelPersonData.needArr.length,0==this.hotelPersonData.waitIndex&&this.personSpine.setTrackCompleteListener(this.personSpine.getCurrent(0),function(){t.movePerson(e)})},touchStart:function(e){var t=this;this.isCanMove&&(!this.isTouch&&this.isWait&&(o.spineAnimationPlay(this.personSpine,"shake"),this.personSpine.setTrackCompleteListener(this.personSpine.getCurrent(0),function(){o.spineAnimationPlay(t.personSpine,t.startWaitAniName,t.startWaitAniLoop)})),this.timerEnd||!this.isTouch||this.isPlayeProp||this.isDroping||this.moveIng||(this.startPos=e.touch.getLocation(),this.lastPos=null,this.zIndexTemp=this.node.zIndex,this.node.zIndex=8,this.changeAniStatePos=this.startPos.x,this.isOpenTimer=!1,this.thinkNode.getComponent(cc.Animation).play("hotelThinkClose"),this.node.scale=1,this.touchFlag=!0,this.isMove=!1,n.curScene.personObj=this.node,this.isWait&&(n.hotelPersonLayerJs.reducePersonWaitIndex(),n.hotelPersonLayerJs.waitCount--,n.hotelPersonLayerJs.waitPersonMove(),this.isWait=!1),o.spineAnimationPlay(this.personSpine,this.startWaitAniName,this.startWaitAniLoop),n.curScene.newUser<=1&&(0==this.hotelPersonData.personIndex||1==this.hotelPersonData.personIndex)&&(n.curScene.guideNode.active=!1)))},touchMove:function(e){if(this.isCanMove&&!(this.timerEnd||!this.isTouch||this.isPlayeProp||this.isDroping||this.moveIng)&&this.touchFlag){var t=e.touch.getLocation();if(null!=this.lastPos){var n=t.x-this.lastPos.x,o=t.y-this.lastPos.y;this.node.x+=n,this.node.y+=o,this.personAniState(n),this.bgMoveFunc(t.x)}this.lastPos=t}},touchEnd:function(){this.isCanMove&&(this.timerEnd||!this.isTouch||this.isPlayeProp||this.isDroping||this.moveIng||(n.curScene.personBgMove=!1,this.touchFlag=!1,this.prop_touch(),this.isPlayeProp||this.dropFunc(this.node.y)))},prop_touch:function(){if(this.oncollisionFlag){this.oncollisionFlag=!1;var e=this.otherCollider.node,t=e.name.substr(5);if(n.hotelPersonLayerJs.personNeedEnum[t]!=this.needName)return void(this.PlayePropErr=!0);if(n.hotelPropLayerJs.isPropHasPos(this.otherCollider))switch(this.isPlayeProp=!0,this.isMove=!1,this.node.pauseSystemEvents(),this.otherTween&&this.otherTween.stop(),this.otherTween=cc.tween(e).to(.1,{scale:this.otherNodeScale}),this.otherTween.start(),t){case"bed1":case"bed2":case"bed3":n.hotelPropLayerJs.prop_Bed(this.selfCollider,this.otherCollider);break;case"potion":n.hotelPropLayerJs.prop_Potion(this.selfCollider,this.otherCollider);break;case"make1":case"make2":n.hotelPropLayerJs.prop_Make(this.selfCollider,this.otherCollider);break;case"crucible":n.hotelPropLayerJs.prop_Crucible(this.selfCollider,this.otherCollider);break;case"dessert":n.hotelPropLayerJs.prop_Dessert(this.selfCollider,this.otherCollider)}}},bgMoveFunc:function(e){var t,o=n.curScene.winSizeWidth<2300;o&&e>n.curScene.winSizeWidth-50?(n.curScene.personBgMove=!0,t=1):o&&e<50?(n.curScene.personBgMove=!0,t=-1):(n.curScene.personBgMove=!1,n.curScene.personBgMoveSpeed=0),(e>n.curScene.winSizeWidth-50||e<50)&&(n.curScene.personBgMoveSpeed=20*t)},personAniState:function(e){var t="",n=!0;Math.abs(this.changeAniStatePos-e)<10||(this.changeAniStatePos=e,(t=e>0?"right":e<0?"left":"center")==this.lastDirectionName&&(n=!1),n&&("right"==t?(this.personNode.scaleX=1,this.hotelPersonData.dir="R"):"left"==t&&(this.personNode.scaleX=-1,this.hotelPersonData.dir="L"),o.spineAnimationPlay(this.personSpine,this.startWaitAniName,this.startWaitAniLoop)),this.lastDirectionName=t)},onCollisionEnter:function(){this.otherTween=null},onCollisionStay:function(e,t){this.stayFunc(e,t,0)},onCollisionExit:function(e){this.oncollisionFlag=!1,this.isMove||this.isDroping||this.otherNodeScale&&(this.otherTween&&this.otherTween.stop(),this.otherTween=cc.tween(e.node).to(.1,{scale:this.otherNodeScale}),this.otherTween.start())},stayFunc:function(e,t,o){if(!this.oncollisionFlag){var i=0==o?e.node:e;i.name.substr(5),n.hotelPropLayerJs.isPropHasPos(e)&&(this.isMove||!this.touchFlag||this.moveIng||this.oncollisionFlag||this.isPlayeProp||this.isDroping||(this.otherCollider!=e&&this.otherCollider&&(this.otherCollider.node.scale=this.otherCollider.node._scale),this.otherCollider=e,this.selfCollider=t,this.oncollisionFlag=!0,this.otherNodeScale=e.node._scale,this.oncollisionType=o,0==o&&(this.otherTween&&this.otherTween.stop(),this.otherTween=cc.tween(i).to(.1,{scale:this.otherNodeScale+.05}),this.otherTween.start())))}},dropFunc:function(e){var t=this;this.isDroping=!0;var i=e>-350?-290:-520,s=e>-350?4:6;this.node.zIndex=s,this.node.scale=this._personScale;var a=Math.abs(e-i)/1e3;cc.tween(this.node).to(a,{y:i}).call(function(){t.isDroping=!1;var e=!1;if(0==n.curScene.newUser&&0==t.hotelPersonData.personIndex?(n.curScene.node.emit("guide",0),e=!0):1==n.curScene.newUser&&1==t.hotelPersonData.personIndex&&(n.curScene.node.emit("guide",1),e=!0),e)return t.PlayePropErr=!1,void t.dropEndFunc();t.PlayePropErr?(t.PlayePropErr=!1,o.spineAnimationPlay(t.personSpine,"shake"),t.personSpine.setTrackCompleteListener(t.personSpine.getCurrent(0),function(){t.dropEndFunc()})):t.dropEndFunc()}).start()},dropEndFunc:function(){this.isMove=!0,o.spineAnimationPlay(this.personSpine,this.startWalkAniName,this.startWalkAniLoop),this.thinkNode.getComponent(cc.Animation).play("hotelThinkOpen"),this.isOpenTimer=!0},movePerson:function(e){this.hotelPersonData.waitIndex>=0&&this.isWait&&!this.timerEnd&&(this.isStartGame=e,this.moveIng=!0,n.hotelPersonLayerJs.addNextPerson(),o.spineAnimationPlay(this.personSpine,this.startWalkAniName,this.startWalkAniLoop))},setPause:function(e){this.moveIng&&(this.moveStop=e),this.personSpine&&(this.personSpine.paused=e)},randNumMoveSpeed:function(){var e=Math.floor(5*Math.random());this.moveSpeed=[90,95,100,105,110][e]},backTipsType:function(){this.needName=this.hotelPersonData.needArr[this.needIndex],this.startWaitAniName=["sad","idle"],this.startWaitAniLoop=[!0,!0],this.startWalkAniName=["sad","walk"],this.startWalkAniLoop=[!0,!0]},setThink:function(){this.isTouch&&(this.thinkNode.getComponent(cc.Animation).play("hotelThinkOpen"),this.isOpenTimer=!0),this.thinkImageNode.getComponent(cc.Sprite).spriteFrame=n.hotelPersonLayerJs.needTipFrameArr[this.needName-1],this.progressFrameSprite.spriteFrame=n.hotelPersonLayerJs.progressFrameArr[0]},update:function(e){var t=this;if(this.isMove&&!n.curScene.gamePause){var i=n.hotelPersonLayerJs.maxPersonPosX,s=-i,a=(e=e>1?.016:e)*this.moveSpeed;if(this.node.x<i&&this.node.x>s||this.endGame||this.timerEnd)(this.endGame||this.timerEnd)&&(a*=2.5),"R"==this.hotelPersonData.dir?this.node.x+=a:this.node.x-=a,(this.endGame||this.timerEnd)&&this.node.x>i+300&&this.removeNode();else{var r=this.node.x>=i;this.node.x=r?i-a-5:s+a+5,this.hotelPersonData.dir=r?"L":"R",this.personNode.scaleX=r?-1:1}}if(!n.curScene.gamePause&&this.isOpenTimer&&this.timerNum>0&&(this.timerNum-=e,this.timerNum<5&&(this.progressFrameSprite.spriteFrame=n.hotelPersonLayerJs.progressFrameArr[1]),this.progressFrameSprite.fillRange=this.timerNum/this.needTimer,this.timerNum<=0&&(this.thinkNode.getComponent(cc.Animation).play("hotelThinkClose"),this.isOpenTimer=!1,this.isMove=!1,this.leaveThinkNode.getComponent(cc.Animation).play("hotelThinkOpen"),this.leaveImageNode.getComponent(cc.Sprite).spriteFrame=n.hotelPersonLayerJs.leaveFrameArr[0],this.timerEnd=!0,o.spineAnimationPlay(this.personSpine,"shake"),this.personSpine.setTrackCompleteListener(this.personSpine.getCurrent(0),function(){n.hotelPersonLayerJs.leavePersonNum++,o.spineAnimationPlay(t.personSpine,t.startWalkAniName,t.startWalkAniLoop),t.isWait?t.waitLeaveTween():t.isMove=!0,0==n.hotelPersonLayerJs.waitCount?n.hotelPersonLayerJs.addNextPerson():1==n.hotelPersonLayerJs.waitCount&&n.hotelPersonLayerJs.waitPersonMove()}))),this.moveIng&&!this.moveStop){this.hotelPersonData.waitIndex<0&&(this.hotelPersonData.waitIndex=0);var h=n.hotelPersonLayerJs.personStartPos+220*this.hotelPersonData.waitIndex;this.node.x-=5,this.node.x<=h&&(this.isStartGame&&0==this.hotelPersonData.waitIndex&&(n.curScene.isBgMoveTouch=!0),this.isCanMove||(this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.isCanMove=!0),this.isStartGame=!1,this.moveIng=!1,this.hotelPersonData.waitIndex<=0&&(this.isTouch=!0,this.setThink(),0==n.curScene.newUser&&0==this.hotelPersonData.personIndex?n.curScene.node.emit("guide",0):1==n.curScene.newUser&&1==this.hotelPersonData.personIndex&&n.curScene.node.emit("guide",1)),o.spineAnimationPlay(this.personSpine,this.startWaitAniName,this.startWaitAniLoop))}},waitLeaveTween:function(){var e=this;n.hotelPersonLayerJs.waitCount--,n.hotelPersonLayerJs.reducePersonWaitIndex(),this.node.zIndex=1,this.personNode.scaleX=1;var t=cc.winSize.width,o=this.node.y;cc.tween(this.node).to(.2,{y:o+20}).call(function(){}).to(3,{x:t}).call(function(){e.removeNode()}).start()},removeNode:function(){n.curScene.personJsArr[this.hotelPersonData.personIndex]=null,this.node.removeFromParent(),this.node.destroy()},reduceWaitIndex:function(){this.hotelPersonData.waitIndex>=0&&this.hotelPersonData.waitIndex--}}),cc._RF.pop()},{EngineCommon:void 0,GameControl:void 0,MathModule:void 0}],HotelPropLayer:[function(e,t){"use strict";cc._RF.push(t,"2c7edr8Np1CMbX+GVyxUBNs","HotelPropLayer");var n=e("GameControl"),o=e("StorageModule"),i=e("EngineCommon"),s=e("MathModule");cc.Class({extends:cc.Component,properties:{propSpineArr:{type:sp.Skeleton,default:[]}},onLoad:function(){n.hotelPropLayerJs=this},start:function(){this._personScale=n.hotelPersonLayerJs.personScale},init:function(){this.game_crucible=this.node.getChildByName("game_crucible"),0==parseInt(o.getData("game_crucible",0))&&n.curScene.hotelLevel<=2&&(this.game_crucible.active=!1),this.game_bed3=this.node.getChildByName("game_bed3"),0==parseInt(o.getData("game_bed3",0))&&n.curScene.hotelLevel<=4&&(this.game_bed3.active=!1),this.game_make2=this.node.getChildByName("game_make2"),0==parseInt(o.getData("game_make2",0))&&n.curScene.hotelLevel<=7&&(this.game_make2.active=!1),this.game_dessert=this.node.getChildByName("game_dessert"),0==parseInt(o.getData("game_dessert",0))&&n.curScene.hotelLevel<=10&&(this.game_dessert.active=!1)},startLoadNewProp:function(){switch(n.curScene.hotelLevel){case 2:this.prop_ScaleAni(this.game_crucible,"game_crucible");break;case 4:this.prop_ScaleAni(this.game_bed3,"game_bed3");break;case 7:this.prop_ScaleAni(this.game_make2,"game_make2");break;case 10:this.prop_ScaleAni(this.game_dessert,"game_dessert")}},prop_ScaleAni:function(e,t){1!=parseInt(o.getData(t,0))&&(e.active=!0,e.scale=.5,cc.tween(e).to(.5,{scale:1},{easing:"elasticOut"}).call(function(){o.setData(t,1)}).start())},prop_Bed:function(e,t){var s=this,a=e.node,r=t.node,h=a.getComponent("HotelPerson"),c=r.getChildByName("personNode");1==n.curScene.newUser&&(n.curScene.newUser=2,n.curScene.pauseGame(!1),n.curScene.isBgMoveTouch=!0,o.setData("hotel_newUser",n.curScene.newUser)),a.parent=c,a.x=0,a.y=0,a.scale=this._personScale,h.personNode.scale=1;var l=r.getChildByName("lvguanchuang").getComponent(sp.Skeleton);i.spineAnimationPlay(l,"play"),i.spineAnimationPlay(h.personSpine,"lvguan-chuang"),h.personSpine.setTrackCompleteListener(h.personSpine.getCurrent(0),function(){i.spineAnimationPlay(l,"Idle"),s.propEnd(h,a,-290,4,"bed")})},prop_Potion:function(e,t){var o=this,s=e.node,a=t.node,r=s.getComponent("HotelPerson"),h=a.getChildByName("personNode");0==n.curScene.newUser&&(n.curScene.newUser=1,n.curScene.pauseGame(!1)),s.parent=h,s.x=0,s.y=0,s.scale=this._personScale,r.personNode.scale=1;var c=a.getChildByName("lvguanyaoshui").getComponent(sp.Skeleton);i.spineAnimationPlay(r.personSpine,"lvguan-yaoshui"),i.spineAnimationPlay(c,"play"),r.personSpine.setTrackCompleteListener(r.personSpine.getCurrent(0),function(){i.spineAnimationPlay(c,"Idle"),o.propEnd(r,s,-520,6,"potion")})},prop_Make:function(e,t){var n=this,o=e.node,a=t.node,r=o.getComponent("HotelPerson"),h=a.getChildByName("personNode");o.parent=h,o.x=0,o.y=0,o.scale=this._personScale,r.personNode.scale=1;var c=a.getChildByName("lvguandatie").getComponent(sp.Skeleton),l=s.rangeRandom(1,4);i.spineAnimationPlay(c,"play"+l),1==l?i.spineAnimationPlay(r.personSpine,"lvguan-datie"):i.spineAnimationPlay(r.personSpine,"lvguan-datie"+l),r.personSpine.setTrackCompleteListener(r.personSpine.getCurrent(0),function(){i.spineAnimationPlay(c,"Idle"),n.propEnd(r,o,-290,4,"make")})},prop_Crucible:function(e,t){var n=this,o=e.node,a=t.node,r=o.getComponent("HotelPerson"),h=a.getChildByName("personNode");o.parent=h,o.x=0,o.y=0,o.scale=this._personScale,r.personNode.scale=1;var c=a.getChildByName("lvguanguo").getComponent(sp.Skeleton),l=s.rangeRandom(1,4);i.spineAnimationPlay(c,"play"+l),i.spineAnimationPlay(r.personSpine,"lvguan-guo"),r.personSpine.setTrackCompleteListener(r.personSpine.getCurrent(0),function(){i.spineAnimationPlay(c,"Idle"),n.propEnd(r,o,-290,4,"crucible")})},prop_Dessert:function(e,t){var n=this,o=e.node,a=t.node,r=o.getComponent("HotelPerson"),h=a.getChildByName("personNode");o.parent=h,o.x=0,o.y=0,o.scale=this._personScale,r.personNode.scale=1;var c=a.getChildByName("lvguanmianbao").getComponent(sp.Skeleton),l=s.rangeRandom(1,3);i.spineAnimationPlay(c,"play"+l),i.spineAnimationPlay(r.personSpine,"lvguan-chidongxi"),r.personSpine.setTrackCompleteListener(r.personSpine.getCurrent(0),function(){i.spineAnimationPlay(c,"Idle"),n.propEnd(r,o,-290,4,"dessert")})},propEnd:function(e,t,o,s){var a=t.convertToWorldSpaceAR(cc.v2(0,0));a=n.hotelPersonLayerJs.node.convertToNodeSpaceAR(a),t.parent=n.hotelPersonLayerJs.node,t.position=a,t.zIndex=6==s?5:1,i.spineAnimationPlay(e.personSpine,["walk","happy"],[!0,!0]),t.scale=this._personScale,e.randNumMoveSpeed(),e.hotelPersonData.dir="R";var r=Math.abs((t.y-o)/100);cc.tween(t).to(r,{y:o}).call(function(){t.zIndex=s,e.needIndex++,e.needIndex>=e.needMaxIndex||e.timerEnd?(n.hotelPersonLayerJs.completeCount++,e.endGame=!0,e.leaveThinkNode.getComponent(cc.Animation).play("hotelThinkOpen"),e.leaveImageNode.getComponent(cc.Sprite).spriteFrame=n.hotelPersonLayerJs.leaveFrameArr[1],n.hotelPersonLayerJs.completeCount>=n.curScene.personLevelNum&&n.curScene.sucPanelNode_open()):(e.node.resumeSystemEvents(),e.backTipsType(),e.setThink(),e.timerNum=e.needTimer),e.isMove=!0,e.isPlayeProp=!1}).start()},isPropHasPos:function(e){return 0==e.node.getChildByName("personNode").childrenCount},setPause:function(e){for(var t=0,n=this.propSpineArr.length;t<n;t++)this.propSpineArr[t].paused=e}}),cc._RF.pop()},{EngineCommon:void 0,GameControl:void 0,MathModule:void 0,StorageModule:void 0}],HotelTimerLayer:[function(e,t){"use strict";cc._RF.push(t,"f538aBaDHZE6LNFFE4o/Cuz","HotelTimerLayer");var n=e("GameControl"),o=e("TimeModule");cc.Class({extends:cc.Component,properties:{TimerLabel:cc.Label},onLoad:function(){n.hotelTimerLayerJs=this},start:function(){},init:function(e){void 0===e&&(e=!1),this.timer=0==e?n.curScene.levelTimer:60,this.TimerLabel.string=o.timeFormat(this.timer,!1),this.schedule(this.updateTimer,1)},updateTimer:function(){n.curScene.gamePause||(this.timer--,this.timer>=0?this.TimerLabel.string=o.timeFormat(this.timer,!1):(this.stopUpdateTimer(),n.curScene.failPanelNode_open()))},stopUpdateTimer:function(){this.unschedule(this.updateTimer)}}),cc._RF.pop()},{GameControl:void 0,TimeModule:void 0}],Hotel:[function(e,t){"use strict";cc._RF.push(t,"1f425D/QIRJLrDpC4eXqkYh","Hotel");var n=e("GameControl"),o=e("GameCommon"),i=e("StorageModule"),s=e("StatisticsModule"),a=e("EngineCommon"),r=e("LanguageModule"),h=e("AudioModule"),c=e("LoadResModule"),l=e("AdInfo");cc.Class({extends:cc.Component,properties:{cameraNode:cc.Node,GameNode:cc.Node,magicCircleSpine:sp.Skeleton,passPanelNode:cc.Node,startGamePanelNode:cc.Node,pausePanelNode:cc.Node,levelLabel:cc.Label,bellLabel:cc.Label,guideNode:cc.Node},onLoad:function(){var e=this;n.curScene=this,lastSceneIndex=sceneIndex,sceneIndex=n.SceneName.hotel,o.handleEventPerScene(),a.enableCollide(),this.newUser=parseInt(i.getData("hotel_newUser",0)),this.node.on("guide",function(t){e.guideFunc(t)}),s.sceneStart("hotel")},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.initData(),this.initUI(),this.initRemindPanel(),this.sizeFit(),this.adHandle(),n.hideLoadingPanel()},onDestroy:function(){s.sceneEnd(),n.curScene=null,n.hotelPersonLayerJs=null,n.hotelPropLayerJs=null},guideFunc:function(e){var t=this;if(this.newUser<=1){var n=this.guideNode.getChildByName("Mask"),o=n.children[0],i=this.guideNode.getChildByName("hand");if(this.pauseGame(!0),this.isBgMoveTouch=!1,0==e){this.guideNode.active=!0;var s=this.GameNode.getChildByName("person0"),a=s.x,r=s.y+200;0!=this.cameraNode.x&&(a-=this.cameraNode.x),n.width=200,n.height=420,n.position=cc.v2(a,r),o.position=cc.v2(-a,-r),i.setPosition(a,r);var h=cc.v2(545,-330);0!=this.cameraNode.x&&(h.x-=this.cameraNode.x),console.log(h.x,a),this.handNodeTween&&this.handNodeTween.stop(),this.handNodeTween=cc.tween(i).repeatForever(cc.tween().to(.7,{position:h}).delay(.5).call(function(){i.setPosition(a,r)})),this.handNodeTween.start()}else 1==e&&function(){t.node.x=0,t.guideNode.active=!0;var e=t.GameNode.getChildByName("person1"),s=e.x,a=e.y+200;0!=t.cameraNode.x&&(s-=t.cameraNode.x),n.width=200,n.height=420,n.position=cc.v2(s,a),o.position=cc.v2(-s,-a),i.setPosition(s,a);var r=cc.v2(-385,88);0!=t.cameraNode.x&&(r.x-=t.cameraNode.x),console.log(r.x,s),t.handNodeTween&&t.handNodeTween.stop(),t.handNodeTween=cc.tween(i).repeatForever(cc.tween().to(.7,{position:r}).delay(.5).call(function(){i.setPosition(s,a)})),t.handNodeTween.start()}()}},initData:function(){n.handTipsTimer=0,this.winSizeWidth=cc.winSize.width,this.maxBgPosX=(2400-this.winSizeWidth)/2,this.maxBgPosX=this.maxBgPosX>0?this.maxBgPosX:null,this.minBgPosX=-this.maxBgPosX,this.hotelLevel=parseInt(i.getData("hotelLevel",1)),this.personJsArr=[],this.personNeedArr=[],this.gamePause=!0,this.loadLevelData(),this.isCountEvent=!0,this.isBgMoveTouch=!1},initUI:function(){n.updateBellNum(this.bellLabel),this.updateAudio(),this.updateMusic(),this.setNodeZIndex(),this.passPanel_open(),this.levelLabel.string="LV:"+this.hotelLevel.toString(),n.hotelPersonLayerJs.init(),n.hotelTimerLayerJs.init(),n.hotelPropLayerJs.init()},sizeFit:function(){if(cc.winSize.width/cc.winSize.height<2.1){this.cameraNode.width=cc.winSize.width,this.cameraNode.height=cc.winSize.height;var e=cc.find("Canvas/bg");console.log(e.width*e.scale-cc.winSize.width),this.cameraNode.x+=(e.width*e.scale-cc.winSize.width)/2}else cc.find("Canvas/UINode/leftHolder").getComponent(cc.Widget).left+=100},adHandle:function(){var e;isHasAd&&(bannerShowFlag[sceneIndex]?l.adsManager.showBanner(2):l.adsManager.hideBanner(),e=lastSceneIndex==sceneIndex?"hotel-replay":"hotel",l.adsManager.showInterVideo(e),l.adsManager.hideCustomAd(),l.adsManager.showCustomAd(2))},initRemindPanel:function(){var e=this;c.getBundleRes(n.gameBundle,"prefabs/miniGameRemindPanel",function(t){var o=cc.instantiate(t);o.active=!1,o.parent=cc.find("Canvas/UINode/PanelNode"),o.position=cc.v2(0,0);var i=a.newSkeletonData(n.skeletonData);e.panelCtrl=o.getComponent("MiniGameRemindPanel"),e.panelCtrl.initPanel(i)},cc.Prefab)},updateAudio:function(){cc.find("audio/selected",this.pausePanelNode).active=h.audioOn},updateMusic:function(){cc.find("music/selected",this.pausePanelNode).active=h.musicOn},touchStart:function(e){!this.gamePause&&this.isBgMoveTouch&&(this.startPos=e.touch.getLocation(),this.moveLastPosX=null)},touchMove:function(e){if(!this.gamePause&&this.isBgMoveTouch){var t=e.touch.getLocation().x;if(null!=this.maxBgPosX&&(Math.abs(t-this.startPos.x)>5||null!=this.moveLastPosX)){if(null!=this.moveLastPosX){var n=this.moveLastPosX-t;this.bgIsMove(n)&&(this.cameraNode.x+=n,this.node.x+=n,this.cameraNode.x>this.maxBgPosX?(this.cameraNode.x=this.maxBgPosX,this.node.x=this.maxBgPosX):this.cameraNode.x<this.minBgPosX&&(this.cameraNode.x=this.minBgPosX,this.node.x=this.minBgPosX))}this.moveLastPosX=t}}},touchEnd:function(){!this.gamePause&&this.isBgMoveTouch&&(this.moveLastPosX=null)},bgIsMove:function(e){return e<0&&this.cameraNode.x>this.minBgPosX||e>0&&this.cameraNode.x<this.maxBgPosX},setNodeZIndex:function(){for(var e={game_bed1:0,game_bed2:0,game_bed3:0,railAfter:0,lvguanchuansong:0,railBefore:3,game_dessert:0,game_potion:5,game_crucible:5,game_make1:5,game_make2:5},t=0,n=this.GameNode.childrenCount;t<n;t++){var o=this.GameNode.children[t],i=o.name;o.zIndex=e[i],o._scale=o.scale}},loadLevelData:function(){var e;if(this.hotelLevel<=30)e=n.hotelLevelNeedData[this.hotelLevel-1];else{var t=Math.floor(3*Math.random()+1);e=n.hotelLevelNeedData[30+t-1]}this.personLevelNum=e.personNum,this.rewardNum=e.rewardCoin,this.levelTimer=this.personLevelNum<=10?90:120;var o=e.personNeedArr;if(1==e.isRandNeed)for(var i=0,s=o.length;i<s;i++)for(var a=o[i],r=0;r<a;r++){var h=n.hotelNeedData[i],c=Object.keys(h),l=h[c[Math.floor(Math.random()*(c.length-1)+1)]];this.personNeedArr.push(l)}else this.personNeedArr=o},startGame:function(){n.curScene.startGamePanelNode.active=!0;var e=n.curScene.startGamePanelNode.getChildByName("bottom").getComponent(cc.Animation);e.play(),e.on("finished",function(){n.curScene.startGamePanelNode.active=!1,n.curScene.gamePause=!1,n.curScene.newUser>1&&(n.curScene.isBgMoveTouch=!0),n.hotelPersonLayerJs.addPerson(0,0),n.hotelPropLayerJs.startLoadNewProp()},n.curScene)},pauseGame:function(e){this.gamePause=e,n.hotelPropLayerJs.setPause(e);for(var t=0,o=this.personJsArr.length;t<o;t++){var i=this.personJsArr[t];i&&i.setPause(e)}},updatePanel:function(e,t,o,a){var r=0,h=0;"success"==a?(r=n.curScene.personLevelNum,h=n.curScene.rewardNum,n.curScene.hotelLevel=parseInt(n.curScene.hotelLevel)+1,i.setData("hotelLevel",n.curScene.hotelLevel),s.eventStatistics("hotelLevelSuc"+n.curScene.hotelLevel)):(r=n.hotelPersonLayerJs.completeCount,h=Math.floor(this.rewardNum/2),s.eventStatistics("hotelLevelFail"+n.curScene.hotelLevel)),t.string=r.toString(),e.string=h.toString(),n.updateBellNum(n.curScene.bellLabel,h);var c=i.getData("hotelHighScore",0);r>c&&(c=r,i.setData("hotelHighScore",c)),o.string=c.toString(),n.curScene.bellLabel.node.parent.active=!0},reviveHandle:function(){n.curScene.pauseGame(!1),n.hotelTimerLayerJs.init(!0)},passPanel_open:function(){var e=this.passPanelNode.getChildByName("bottom"),t=cc.find("layout/labelUp",e).getComponent(cc.Label),n=cc.find("layout/bell/label",e).getComponent(cc.Label),o="\u9700\u8981\u5e2e\u52a9 &1 \u4f4d\u65c5\u5ba2";o=(o=r.translateString(o)).replace("&1",this.personLevelNum),t.string=o,n.string=this.rewardNum.toString(),this.passPanelNode.active=!0},sucPanelNode_open:function(){n.hotelTimerLayerJs.stopUpdateTimer(),this.playGameSuccessMusic(),this.panelCtrl.showPanel("success")},failPanelNode_open:function(){this.pauseGame(!0),isHasAd?n.curScene.panelCtrl.showPanel("revive"):n.curScene.panelCtrl.showPanel("fail")},btnMusic:function(){h.playEffect("click"),h.setMusicFlag(!h.musicOn),h.musicOn?h.playMusic():h.stopMusic(),this.updateMusic()},btnAudio:function(){h.playEffect("click"),h.setAudioFlag(!h.audioOn),this.updateAudio()},btnStart:function(){this.passPanelNode.active=!1,this.startGame()},btnBack:function(){h.playEffect("click"),n.showLoadingPanel(function(){cc.director.loadScene("game")})},btnPause:function(){h.playEffect("click");var e=cc.find("label",this.pausePanelNode).getComponent(cc.Label),t="\u8fd8\u9700\u5e2e\u52a9&1\u4f4d\u65c5\u5ba2",o=this.personLevelNum-n.hotelPersonLayerJs.completeCount;t=(t=r.translateString(t)).replace("&1",o),e.string=t,this.pausePanelNode.active=!0,this.pauseGame(!0)},btnClosePause:function(){h.playEffect("click"),this.pausePanelNode.active=!1,this.pauseGame(!1)},update:function(){this.personBgMove&&!this.gamePause&&this.bgIsMove(this.personBgMoveSpeed)&&(this.cameraNode.x+=this.personBgMoveSpeed,this.node.x=this.cameraNode.x,this.personObj.x+=this.personBgMoveSpeed)},playClickSound:function(){h.playEffect("click")},playGameSuccessMusic:function(){h.playEffect("success")},playParkourJumpOrDown:function(){h.playEffect("jump")},playCoinSound:function(){h.playEffect("coin")}}),cc._RF.pop()},{AdInfo:void 0,AudioModule:void 0,EngineCommon:void 0,GameCommon:void 0,GameControl:void 0,LanguageModule:void 0,LoadResModule:void 0,StatisticsModule:void 0,StorageModule:void 0}]},{},["Hotel","HotelPerson","HotelPersonLayer","HotelPropLayer","HotelTimerLayer"]);