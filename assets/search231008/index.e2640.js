window.__require=function e(t,n,i){function r(o,c){if(!n[o]){if(!t[o]){var s=o.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+o+"'")}o=s}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){return r(t[o][1][e]||e)},h,h.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof __require&&__require,o=0;o<i.length;o++)r(i[o]);return r}({Item:[function(e,t){"use strict";cc._RF.push(t,"c0de6e1G2NBkoG23Fr6vsgN","Item");var n=e("GameControl");cc.Class({extends:cc.Component,properties:{image:cc.Sprite,isOnEvent:{default:!1,visible:!1}},initItem:function(e,t,i,r){this.index=e,this.node.width=t,this.node.height=t,this.node.x=i,this.node.y=r;var a=Math.round(360*Math.random());this.image.node.angle=a,this.picIndex=n.vectorControl.picIndexArr[e],this.image.spriteFrame=n.curScene.searchRes[this.picIndex],this.node.active=!0,this.image.node.scale=1,n.curScene.bigTween.clone(this.node).start(),this.isOnEvent||this.touchOn()},touchOn:function(){this.isOnEvent=!0,this.image.node.on("touchend",this.touchEvent,this)},touchOff:function(){this.image.node.off("touchend",this.touchEvent,this),this.isOnEvent=!1},touchEvent:function(e){"touchend"==e.type&&this.picIndex==n.vectorControl.curTargetIndex&&(this.node.scale=1,this.node.getComponent(cc.Animation).stop(),n.curScene.tipFlag=!1,this.touchOff(),0==n.vectorControl.targetIndexArr.length?(n.curScene.isSuccess=!0,n.vectorControl.curTargetIndex=-1):n.vectorControl.curTargetIndex=n.vectorControl.targetIndexArr.shift(),n.curScene.curScore++,cc.tween(this.image.node).then(n.curScene.clickTween).start(),n.curScene.spendTime=0,n.curScene.resumeTipState())}}),cc._RF.pop()},{GameControl:void 0}],Search:[function(e,t){"use strict";cc._RF.push(t,"e620e7V9FhPJriearFB8Ex2","Search");var n=e("GameCommon"),i=e("GameControl"),r=e("StorageModule"),a=e("LoadResModule"),o=e("StatisticsModule"),c=e("AudioModule"),s=e("AdInfo"),l=e("EngineCommon");cc.Class({extends:cc.Component,properties:{maskNode:cc.Node,levelTarget:cc.Node,timeProgressBar:cc.Sprite,propTime:cc.Node,propTip:cc.Node,bellLabel:cc.Label,targetProgress:cc.Sprite,panelHolder:cc.Node,startGamePanelNode:cc.Node},onLoad:function(){i.curScene=this,lastSceneIndex=sceneIndex,sceneIndex=i.SceneName.search,n.handleEventPerScene(),this.zoomAnim=cc.tween().repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})),this.propTipAnimPlaying=!1,this.propTimeAnimPlaying=!1,this.smallTween=cc.tween().to(.2,{scale:0}),this.bigTween=cc.tween().to(.2,{scale:1}),this.clickTween=cc.tween().to(.3,{scale:1.2}).parallel(cc.tween().to(.2,{scale:0}),cc.tween().to(.2,{angle:360})).call(function(){i.vectorControl.showTarget()}),this.scaleTween=cc.tween().repeatForever(cc.tween().to(.5,{scale:1.2}).to(.5,{scale:1})),o.sceneStart("Find")},onDestroy:function(){o.sceneEnd(),i.curScene=null},start:function(){this.initData(),this.initRemindPanel(),this.initUI(),this.loadRes(),this.adHandle()},initData:function(){this.curScore=0,this.propTimeNum=parseInt(r.getData("searchTipNum",1)),this.propTipNum=parseInt(r.getData("searchTimeNum",1)),this.searchLevel=parseInt(r.getData("searchLevel",0)),i.bellNum=r.getData("bellNum",0)},initRemindPanel:function(){var e=this;a.getBundleRes(i.gameBundle,"prefabs/miniGameRemindPanel",function(t){var n=cc.instantiate(t);n.active=!1,n.parent=e.panelHolder,n.position=cc.v2(0,0);var r=l.newSkeletonData(i.skeletonData);e.panelCtrl=n.getComponent("MiniGameRemindPanel"),e.panelCtrl.initPanel(r)},cc.Prefab)},initUI:function(){this.levelTarget.scale=0,this.startGamePanelNode.active=!0,i.updateBellNum(this.bellLabel),this.propTip.parent.active=isHasAd,this.updateProp("tip"),this.updateProp("time")},adHandle:function(){var e;isHasAd&&(bannerShowFlag[sceneIndex]?s.adsManager.showBanner():s.adsManager.hideBanner(),e=lastSceneIndex==sceneIndex?"search-replay":"search",s.adsManager.showInterVideo(e),"wx"==channel&&s.adsManager.hideCustomAd())},updateProp:function(e,t){void 0===t&&(t=0),"tip"==e?(0!=t&&(this.propTipNum=parseInt(this.propTipNum)+t,r.setData("searchTipNum",this.propTipNum)),this.propTipNum>0?(cc.find("labelBottom/add",this.propTip).active=!1,cc.find("labelBottom/num",this.propTip).getComponent(cc.Label).string=this.propTipNum):cc.find("labelBottom/add",this.propTip).active=!0):"time"==e&&(0!=t&&(this.propTimeNum=parseInt(this.propTimeNum)+t,r.setData("searchTimeNum",this.propTimeNum)),this.propTimeNum>0?(cc.find("labelBottom/add",this.propTime).active=!1,cc.find("labelBottom/num",this.propTime).getComponent(cc.Label).string=this.propTimeNum):cc.find("labelBottom/add",this.propTime).active=!0)},loadRes:function(){var e=this;a.getBundleRes(i.searchBundle,"desserts",function(t){e.searchRes=t,i.vectorControl.initData(),i.hideLoadingPanel(function(){e.timeDown(3)})},cc.Director,cc.SpriteFrame)},btnCreate:function(){i.vectorControl.initData()},timeDown:function(){var e=this,t=this.startGamePanelNode.getChildByName("bottom").getComponent(cc.Animation);t.play(),t.on("finished",function(){cc.tween(i.curScene.levelTarget).to(1,{scale:1}).start(),e.startGamePanelNode.active=!1,e.timeProgress()},this)},timeProgress:function(){this.isSuccess=!1;var e=20;this.searchLevel>30?e=10:this.searchLevel>20&&(e=15),this.totalTime=e,this.remainTime=e,this.timeProgressBar.fillRange=1,this.spendTime=0,this.schedule(this.timeFunc,1)},timeFunc:function(){if(this.spendTime+=1,this.remainTime-=1,this.timeProgressBar.fillRange=Number((this.remainTime/this.totalTime).toFixed(2)),this.remainTime<=0)return this.timeProgressBar.fillRange=0,void this.showFailPanel();this.remainTime<5&&!this.propTimeAnimPlaying&&(this.zoomAnim.clone(this.propTime).start(),this.propTimeAnimPlaying=!0),this.spendTime>=5&&!this.propTipAnimPlaying&&(this.zoomAnim.clone(this.propTip).start(),this.propTipAnimPlaying=!0)},btnTip:function(){var e=this;this.tipFlag||(c.playEffect("click"),this.resumeTipState(),this.propTipNum>0?(this.tipFlag=!0,this.updateProp("tip",-1),i.vectorControl.toolTip()):s.adsManager.showVideo("searchPropTip",function(t){t&&e.updateProp("tip",1)}))},resumeTipState:function(){this.propTip.stopAllActions(),this.propTipAnimPlaying=!1,this.propTip.scale=1,this.spendTime=0},btnAddTime:function(){var e=this;c.playEffect("click"),this.resumeTimeState(),this.propTimeNum>0?(this.updateProp("time",-1),this.addTime()):s.adsManager.showVideo("searchPropTime",function(t){t&&e.updateProp("time",1)})},resumeTimeState:function(){this.propTime.stopAllActions(),this.propTimeAnimPlaying=!1,this.propTime.scale=1},addTime:function(){i.curScene.remainTime=i.curScene.remainTime+10>i.curScene.totalTime?i.curScene.totalTime:i.curScene.remainTime+10,i.curScene.timeProgressBar.fillRange=Number((i.curScene.remainTime/i.curScene.totalTime).toFixed(2))},updatePanel:function(e,t,n,a){t.string=i.curScene.curScore.toString();var c=0;"success"==a?(c=2*i.curScene.curScore+5*Math.floor(i.curScene.searchLevel/3),o.eventStatistics("searchSuc"),i.curScene.searchLevel=parseInt(i.curScene.searchLevel)+1,r.setData("searchLevel",i.curScene.searchLevel)):(c=2*i.curScene.curScore,o.eventStatistics("searchFail")),c=Math.min(c,50),e.string=c.toString(),i.updateBellNum(i.curScene.bellLabel,c)},showSuccessPanel:function(){this.unschedule(this.timeFunc),this.resumeTipState(),this.resumeTimeState(),i.curScene.panelCtrl.showPanel("success")},showFailPanel:function(){this.isSuccess||(this.unschedule(this.timeFunc),this.resumeTipState(),this.resumeTimeState(),isHasAd?i.curScene.panelCtrl.showPanel("revive"):i.curScene.panelCtrl.showPanel("fail"))},btnPause:function(){c.playEffect("click"),this.unschedule(this.timeFunc),this.panelCtrl.showPanel("pause")},continueHandle:function(){i.curScene.schedule(i.curScene.timeFunc,1)},reviveHandle:function(){i.curScene.addTime(),i.curScene.schedule(i.curScene.timeFunc,1)}}),cc._RF.pop()},{AdInfo:void 0,AudioModule:void 0,EngineCommon:void 0,GameCommon:void 0,GameControl:void 0,LoadResModule:void 0,StatisticsModule:void 0,StorageModule:void 0}],VectorControl:[function(e,t){"use strict";function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}cc._RF.push(t,"f01c67+8wRG0qk2xDSTQKLv","VectorControl");var a=e("GameControl"),o=e("ObjModule"),c=e("MathModule"),s=[{targetNum:3,typeNum:6,totalNum:24,colInRow:[6,6,6,6],shape:"rect"},{targetNum:4,typeNum:7,totalNum:32,colInRow:[6,6,8,6,6],shape:"rect"},{targetNum:5,typeNum:9,totalNum:32,colInRow:[5,7,8,7,5],shape:"ellipse"},{targetNum:6,typeNum:9,totalNum:32,colInRow:[8,8,8,8],shape:"rect"},{targetNum:7,typeNum:11,totalNum:34,colInRow:[6,7,8,7,6],shape:"ellipse"},{targetNum:8,typeNum:12,totalNum:36,colInRow:[6,8,9,8,4,1],shape:"heart"},{targetNum:10,typeNum:14,totalNum:40,colInRow:[10,10,10,10],shape:"rect"},{targetNum:5,typeNum:10,totalNum:46,colInRow:[8,9,10,9,8],shape:"ellipse"},{targetNum:6,typeNum:10,totalNum:46,colInRow:[6,9,10,9,7,4,1],shape:"heart"},{targetNum:6,typeNum:10,totalNum:48,colInRow:[12,12,12,12],shape:"rect"},{targetNum:6,typeNum:12,totalNum:56,colInRow:[6,11,12,11,9,6,1],shape:"heart"}];cc.Class({extends:cc.Component,properties:{itemNode:cc.Node,targetNum:{default:-1,visible:!1},typeNum:{default:-1,visible:!1},totalNum:{default:-1,visible:!1},rowNum:{default:-1,visible:!1}},onLoad:function(){a.vectorControl=this,this.shapeType="rect",a.vectorControl.gameData=s},start:function(){},initData:function(){for(var e,t,i=n(this.node.children);!(e=i()).done;){var r=e.value;r&&a.curScene.smallTween.clone(r).start()}a.curScene.levelTarget.children.forEach(function(e){e.x=0,e.angle=0}),t=a.curScene.searchLevel>=3*s.length?c.rangeRandom(0,s.length):Math.floor(a.curScene.searchLevel/3),console.log("levelIndex="+t),this.targetNum=s[t].targetNum+a.curScene.searchLevel%3,this.typeNum=s[t].typeNum+a.curScene.searchLevel%3,this.totalNum=s[t].totalNum,this.shapeType=s[t].shape,this.colInRow=s[t].colInRow,this.totalTypeNum=this.typeNum+this.targetNum,this.typeNum>this.totalNum&&(this.typeNum=this.totalNum);for(var o=[],l=0;l<a.curScene.searchRes.length;l++)o.push(l);var h=this.randomGenerateArr(o,this.totalTypeNum);this.picIndexArr=this.randomGenerateElements(h,this.totalNum),this.targetIndexArr=this.randomGenerateArr(h,this.targetNum),this.curTargetIndex=this.targetIndexArr.shift(),this.generate(this.shapeType),this.initCurTarget()},generate:function(e){switch(e){case"rect":this.generateRect();break;case"ellipse":this.generateEllipse();break;case"heart":this.generateHeart()}},generateRect:function(){for(var e,t=this.colInRow.length,n=Math.max.apply(Math,this.colInRow),i=Math.floor(this.node.width/n),r=(this.node.height-i-i*t)/(t-1),a=-i,o=0,c=0;c<t;c++)for(var s=(this.node.width-i*this.colInRow[c])/2,l=0;l<this.colInRow[c];l++){var h=s+l*i+i/2,u=a-c*(i+r);(e=this.node.children[o]?this.node.children[o]:cc.instantiate(this.itemNode)).parent=this.node,e.getComponent("Item").initItem(o,i,h,u),o++}},generateEllipse:function(){for(var e,t=this.colInRow.length,n=Math.max.apply(Math,this.colInRow),i=Math.floor(this.node.width/n),r=(this.node.height-i-i*t)/(t-1),a=-i,o=0,c=0;c<t;c++)for(var s=(this.node.width-i*this.colInRow[c])/2,l=0;l<this.colInRow[c];l++){var h=s+l*i+i/2,u=a-c*(i+r);(e=this.node.children[o]?this.node.children[o]:cc.instantiate(this.itemNode)).parent=this.node,e.getComponent("Item").initItem(o,i,h,u),o++}},generateHeart:function(){for(var e,t,n=this.colInRow.length,i=Math.max.apply(Math,this.colInRow),r=Math.floor(this.node.width/i),a=(this.node.height-r*n)/2,o=0,c=0;c<n;c++){e=this.colInRow[c],0==c&&(e+=2);for(var s=(this.node.width-r*e)/2,l=0;l<this.colInRow[c];l++){var h=s+l*r+r/2,u=-(a+c*r+r/2);0==c&&l>=e/2-1&&(h+=2*r),(t=this.node.children[o]?this.node.children[o]:cc.instantiate(this.itemNode)).parent=this.node,t.getComponent("Item").initItem(o,r,h,u),o++}}},showTarget:function(){var e=this;a.curScene.targetProgress.node.parent.active=!1;var t=cc.tween().parallel(cc.tween().to(.5,{x:-600}),cc.tween().to(.5,{angle:180})).call(function(){var t=e.targetNum-(e.targetIndexArr.length+1);if(a.curScene.targetProgress.fillRange=t/e.targetNum,e.targetIndexArr.length>0){var n=e.targetIndexArr[0],i=a.curScene.searchRes[n];a.curScene.levelTarget.children[0].setSiblingIndex(1),a.curScene.levelTarget.children[0].x=0,a.curScene.levelTarget.children[0].angle=0,a.curScene.levelTarget.children[0].getChildByName("image").getComponent(cc.Sprite).spriteFrame=i,a.curScene.targetProgress.node.parent.active=!0}else a.curScene.levelTarget.children[0].setSiblingIndex(1),-1==e.curTargetIndex?a.curScene.showSuccessPanel():a.curScene.targetProgress.node.parent.active=!0});cc.tween(a.curScene.levelTarget.children[1]).then(t).start()},initCurTarget:function(){var e=a.curScene.searchRes[this.curTargetIndex];if(a.curScene.levelTarget.children[1].setSiblingIndex(1),a.curScene.levelTarget.children[1].getChildByName("image").getComponent(cc.Sprite).spriteFrame=e,this.targetIndexArr.length>0){var t=this.targetIndexArr[0];e=a.curScene.searchRes[t],a.curScene.levelTarget.children[0].getChildByName("image").getComponent(cc.Sprite).spriteFrame=e}a.curScene.targetProgress.node.parent.active=!0,a.curScene.targetProgress.fillRange=0},toolTip:function(){for(var e=this.node.children,t=-1,n=0;n<e.length;n++)if(e[n].getComponent("Item").picIndex==this.curTargetIndex){t=n;break}-1!==t&&(this.node.children[t].scale=1,this.node.children[t].getComponent(cc.Animation).play())},randomGenerateArr:function(e,t){if(e)return o.shuffleArr(e),e.slice(0,t);console.log("\u6570\u7ec4\u4e0d\u5408\u6cd5"+e)},randomGenerateElements:function(e,t){for(var n=[],i=0;i<t;i++)if(i<e.length)n.push(e[i]);else{var r=c.rangeRandom(0,e.length);n.push(e[r])}return o.shuffleArr(n)},getRandomArrayElements:function(e,t){e=this.randomArr(e);for(var n=[],i=0,r=0;i<t;i++)n[r]?n[r].num+=1:n[r]={data:e[r],num:1},r=r+1>=e.length?0:r+1;return n},spliceRandomValue:function(e,t){for(var n=[];n.length<t;){var i=Math.floor(Math.random()*e.length),r=e.splice(i,1);n.push(r[0])}return n},randomArr:function(e){for(var t,n,i=e.length;i>0;)t=Math.floor(Math.random()*i),n=e[i-1],e[i-1]=e[t],e[t]=n,i--;return e},getRandomNumber:function(e,t){for(var n=[];n.length<t;){var i=Math.floor(Math.random()*e);-1==n.indexOf(i)&&n.push(i)}return n}}),cc._RF.pop()},{GameControl:void 0,MathModule:void 0,ObjModule:void 0}]},{},["Item","Search","VectorControl"]);